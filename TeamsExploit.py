from TokenSearch.TeamsTokens import get_teams_tokens
import base64
import json

print("\r\nGetting Teams Tokens")


teams_tokens = get_teams_tokens()

for token in teams_tokens:
    split_token = token.split('.')
    decoded_jwt = base64.b64decode(split_token[1] + "==").decode('utf-8')
    converted_token = json.loads(decoded_jwt)

    print("\033[95m Token service:" + converted_token['aud'] + "\033[0m")
    print("Scopes: ")
    print(converted_token['scp'] + "\r\n")